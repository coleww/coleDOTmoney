<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CCCC - Eating Glue</title>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
    <link href="/blog/stylesheets/main.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <center>
<a href="/">        <img class="header" src="/blog/images/cool.png" />
</a>    </center>

    <div id="main" role="main">
      <h1>EATING GLUE</h1>

<h2>Taking Over the Paste Event</h2>

<p>Though they started out as simple document viewers, over the years web browsers have escaped from their sandbox and gained more and more access to operating system level goodness, like your camera and GPS coordinates. This level of intrusivenes used to only be possible for those who made use of awkward Flash hacks, but today this sort of stuff is made available through simple JavaScript APIs to every website you visit. <em>Awesome.</em></p>

<p><img alt="Ralph likes to hack JavaScript" src="/blog/images/paste.jpg" /></p>

<p>One basic computer technology that we can hijack and manipulate however we please is pasting. Some people think it&rsquo;s wrong to mess with fundamental UI behavior like clicking or scrolling or, I suppose, <code>ctrl+v</code>, but I say SHOW ME THE CODE:</p>
<pre class="highlight javascript"><code>    <span class="c1">// take over any paste event that occurs on this page</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'paste'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
      <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">clipboardData</span><span class="p">.</span><span class="nx">getData</span><span class="p">(</span><span class="s1">'text/plain'</span><span class="p">)</span>

      <span class="nx">alert</span><span class="p">(</span><span class="s1">'YOU TRIED TO PASTE '</span> <span class="o">+</span> <span class="nx">data</span> <span class="o">+</span> <span class="s1">', TOO BAD.'</span><span class="p">)</span>

      <span class="k">return</span> <span class="kc">false</span> <span class="c1">// don't let the normal "paste" event happen</span>
    <span class="p">})</span>
</code></pre>

<p>And that&rsquo;s it!</p>

<p><a href="http://stackoverflow.com/questions/6035071/intercept-paste-event-in-javascript">According to my in depth research into this subject</a> you need to use <code>window.clipboardData.getData(&#39;Text&#39;)</code> in IE, or <code>e.originalEvent.clipboardData</code> if you install the event handler with something called &ldquo;Jquery&rdquo;.</p>

<h4>ok but why</h4>

<p>I used this trick to build a <a href="http://coleww.github.io/json-formatter/">JSON formatter</a> [<a href="https://github.com/coleww/json-formatter">code</a>] because I wanted to be able to quickly paste a JSON blob to the page and see it transformed, and an input field or textarea would just get in the way of things.</p>

<p>This approach is also fairly well aligned with the UNIX philosophy, which holds among it&rsquo;s tenets &ldquo;make small things&rdquo; and &ldquo;text in/text out&rdquo;. Only here, input is handled by the paste event and the output is a div. The web page itself does only one thing and nothing else which means it composes well with other modules, like perhaps using <code>cmd+f</code> to find things in the formatted JSON. And if I needed to add an option for controlling the indentation level I could perhaps add it as a query param in the URL.</p>

<p>The JSON formatter is actually just a wrapper around a node module called <a href="https://github.com/JerrySievert/json">json-nice</a>, and there are probably many other small command line tools that could benefit from being turned into tiny web apps. With <a href="https://github.com/substack/browserify-handbook">browserify</a> and <a href="http://maxogden.com/node-packaged-modules.html">npm</a> this becomes really easy.</p>

    </div>

    <aside>
      <p><div id="contact">
        <a href="http://colewillsea.com/">Cole Willsea</a>
        (<a href="https://github.com/coleww">gh</a>)
        (<a href="https://twitter.com/colewillsea">twtr</a>)
      </div></p>
      <h2>RECENT BLAGZ</h2>
      <ol>
          <li><a href="/blog/eating-glue-and-paste.html">Eating Glue</a> <span>Jun  3</span></li>
          <li><a href="/blog/syntax-highlighting-in-middleman.html">100% EZ Syntax Highlighting With Middleman</a> <span>May 30</span></li>
      </ol>

    </aside>
  </body>
</html>
