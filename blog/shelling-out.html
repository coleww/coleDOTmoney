<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>shelling out to the system</title>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
    <link href="/blog/stylesheets/main-9c5606f3.css" rel="stylesheet" type="text/css" />
    <meta name="description" content="Writing code that makes art and vice versa." />
<meta name="keywords" content="ruby, javascript, code, poetry, clojure, npm, algorithm, art" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Writing code that makes art and vice versa." />
<meta property="og:description" content="Writing code that makes art and vice versa." />
  </head>
  <body>
    <center>
<a href="/blog">        <img class="header" src="/blog/images/cool-7b689408.png" />
</a>    </center>

    <div id="main" role="main">
      <h1>Shelling Out</h1>

<h2>I would gladly shell out 5$ for you to pipe a burrito to me, streaming, over the course of the next 7 minutes.</h2>

<p>Traditionally in UNIX land one would connect the output of various programs to the inputs of others with pipes (<code>|</code>) directly on the command line, or within the depths of a shell script, like so:</p>

<p><code>cat recipe.txt | grep potatoes &gt;&gt; potato_ideas.txt</code></p>

<p>This is a great way to compose complex actions out of many small utilities.</p>

<p><img alt="pipe" src="/blog/images/pipe-d875ef91.png" /></p>

<p>Piping works fine for non-interactive programs that are all text-in/text-out, and you can certainly write bash scripts that <code>touch</code> and <code>mkdir</code> your way to many victories, but what about integrating more complicated CLI tools like npm, bower, ember, rails, or git? These programs do things like prompt the user to make decisions, hit the network, or generate a metric ton of files, and it might get unwieldy to try to control such chaos directly from the command line. Instead, you can write a script that shells out to them!</p>

<p><img alt="shelling" src="/blog/images/shelling-019c5ed6.png" /></p>

<p>In Ruby, the easiest way to shell out a command is to put it backticks, like so:</p>
<pre class="highlight ruby"><code><span class="c1"># this would print the current directory</span>
<span class="nb">puts</span> <span class="sb">`ls`</span>
</code></pre>

<p>The same shelling, but with Node.js:</p>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">exec</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'child_process'</span><span class="p">).</span><span class="nx">exec</span>
<span class="nx">exec</span><span class="p">(</span><span class="s1">'ls'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">stdout</span><span class="p">,</span> <span class="nx">stderr</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// this would print the current directory</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">stdout</span><span class="p">)</span>

  <span class="c1">// probably some callback hell here</span>
<span class="p">});</span>
</code></pre>

<p>With these, you can easily run shell commands and respond to their output as part of your script. But what if instead of just running a command you want to turn over control to a different program? Maybe that program has user prompts that need answering or it shows some pretty sweet terminal graphics.</p>

<p>In Ruby you can use <code>exec</code>, which replaces the current process with the given command:</p>
<pre class="highlight ruby"><code><span class="nb">exec</span> <span class="s2">"rails new monolith"</span>
<span class="nb">puts</span> <span class="s2">"never gets here cuz rails takes over"</span>
</code></pre>

<p>In Node.js there is the <a href="https://www.npmjs.com/package/kexec">kexec</a> module, which does the exact same thing:</p>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">kexec</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'kexec'</span><span class="p">)</span>
<span class="nx">kexec</span><span class="p">(</span><span class="s1">'ember new behemoth'</span><span class="p">)</span>
</code></pre>

<p>I used some of these magical spells to build <a href="https://github.com/coleww/mkproj">mkproj</a>, which generates a bunch of files and does some NPM stuff in order to scaffold lil browserify projects. Being able to run code on the command line from a Ruby or Node script opens up tons of possibilities for destroying your computer in a for loop! Reader beware!</p>

      <br/>
      <br/>
      <br/>
      <br/>
      <br/>
      <br/>
      <br/>
      <br/>
      <br/>
      <br/>
      <br/>
      <br/>
    </div>

    <aside>
      <p><div id="contact">
        <a href="http://colewillsea.com/">Cole Willsea</a>
        (<a href="https://github.com/coleww">github</a>)
        (<a href="https://twitter.com/colewillsea">twitter</a>)
      </div></p>
      <h2>RECENT BLAGZ</h2>
      <ul>
          <li><a href="/blog/throwing-errs-js.html">Throwing Good Errors With JavaScript</a> <span>Aug 20</span></li>
          <li><a href="/blog/everything-tmux.html">Everything I Learned About TMUX In 3 Days</a> <span>Aug 15</span></li>
          <li><a href="/blog/context-switching-ember-rails.html">Eliminating The Ember-Rails Context Switch</a> <span>Aug  8</span></li>
          <li><a href="/blog/test-yr-test-suite.html">Meta Test Driven Development</a> <span>Aug  3</span></li>
          <li><a href="/blog/node-poetry-modules.html">Node.js Poetic Modules</a> <span>Aug  1</span></li>
      </ul>

      <h2>TAGZ</h2>
      <ul>
          <li><a href="/blog/blog/tags/unix.html">unix (8)</a></li>
          <li><a href="/blog/blog/tags/node.html">node (7)</a></li>
          <li><a href="/blog/blog/tags/ruby.html">ruby (4)</a></li>
          <li><a href="/blog/blog/tags/command-line.html">command line (2)</a></li>
          <li><a href="/blog/blog/tags/npm.html">npm (2)</a></li>
          <li><a href="/blog/blog/tags/generators.html">generators (2)</a></li>
          <li><a href="/blog/blog/tags/ember.html">ember (2)</a></li>
          <li><a href="/blog/blog/tags/bash.html">bash (2)</a></li>
          <li><a href="/blog/blog/tags/pipe.html">pipe (1)</a></li>
          <li><a href="/blog/blog/tags/magic.html">magic (1)</a></li>
          <li><a href="/blog/blog/tags/glue.html">glue (1)</a></li>
          <li><a href="/blog/blog/tags/paste-events.html">paste events (1)</a></li>
          <li><a href="/blog/blog/tags/john-gruber.html">john gruber (1)</a></li>
          <li><a href="/blog/blog/tags/loading-routes.html">loading routes (1)</a></li>
          <li><a href="/blog/blog/tags/spinner-gif.html">spinner gif (1)</a></li>
          <li><a href="/blog/blog/tags/tom-dale.html">tom dale (1)</a></li>
          <li><a href="/blog/blog/tags/cron-job.html">cron job (1)</a></li>
          <li><a href="/blog/blog/tags/digital-ocean.html">digital ocean (1)</a></li>
          <li><a href="/blog/blog/tags/twitter-bots.html">twitter bots (1)</a></li>
          <li><a href="/blog/blog/tags/path.html">path (1)</a></li>
          <li><a href="/blog/blog/tags/ubuntu.html">ubuntu (1)</a></li>
          <li><a href="/blog/blog/tags/shell-scripts.html">shell scripts (1)</a></li>
          <li><a href="/blog/blog/tags/markdown.html">markdown (1)</a></li>
          <li><a href="/blog/blog/tags/exec.html">exec (1)</a></li>
          <li><a href="/blog/blog/tags/kexec.html">kexec (1)</a></li>
          <li><a href="/blog/blog/tags/middleman.html">middleman (1)</a></li>
          <li><a href="/blog/blog/tags/meta-blog.html">meta-blog (1)</a></li>
          <li><a href="/blog/blog/tags/code.html">code (1)</a></li>
          <li><a href="/blog/blog/tags/cli-tool.html">cli tool (1)</a></li>
          <li><a href="/blog/blog/tags/browser-hijacking.html">browser hijacking (1)</a></li>
          <li><a href="/blog/blog/tags/yargs.html">yargs (1)</a></li>
          <li><a href="/blog/blog/tags/cors.html">cors (1)</a></li>
          <li><a href="/blog/blog/tags/api.html">api (1)</a></li>
          <li><a href="/blog/blog/tags/http.html">http (1)</a></li>
          <li><a href="/blog/blog/tags/the-rocky-mountain-brew.html">the rocky mountain brew (1)</a></li>
          <li><a href="/blog/blog/tags/overtone.html">overtone (1)</a></li>
          <li><a href="/blog/blog/tags/clojure.html">clojure (1)</a></li>
          <li><a href="/blog/blog/tags/noise.html">noise (1)</a></li>
          <li><a href="/blog/blog/tags/pitch.html">pitch (1)</a></li>
          <li><a href="/blog/blog/tags/samples.html">samples (1)</a></li>
          <li><a href="/blog/blog/tags/music.html">music (1)</a></li>
          <li><a href="/blog/blog/tags/poetry.html">poetry (1)</a></li>
          <li><a href="/blog/blog/tags/literature.html">literature (1)</a></li>
          <li><a href="/blog/blog/tags/testing.html">testing (1)</a></li>
          <li><a href="/blog/blog/tags/tdd.html">tdd (1)</a></li>
          <li><a href="/blog/blog/tags/meta-tdd.html">meta-tdd (1)</a></li>
          <li><a href="/blog/blog/tags/syntax-highlighting.html">syntax highlighting (1)</a></li>
          <li><a href="/blog/blog/tags/rails.html">rails (1)</a></li>
          <li><a href="/blog/blog/tags/tmux.html">tmux (1)</a></li>
          <li><a href="/blog/blog/tags/ssh.html">ssh (1)</a></li>
          <li><a href="/blog/blog/tags/emacs.html">emacs (1)</a></li>
          <li><a href="/blog/blog/tags/multiplexing.html">multiplexing (1)</a></li>
          <li><a href="/blog/blog/tags/javascript.html">javascript (1)</a></li>
          <li><a href="/blog/blog/tags/error-handling.html">error handling (1)</a></li>
          <li><a href="/blog/blog/tags/errors.html">errors (1)</a></li>
          <li><a href="/blog/blog/tags/problems.html">problems (1)</a></li>
          <li><a href="/blog/blog/tags/throwing.html">throwing (1)</a></li>
          <li><a href="/blog/blog/tags/catching.html">catching (1)</a></li>
      </ul>
    </aside>
    <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(["_setAccount", "UA-26036675-1"]);
  _gaq.push(["_trackPageview"]);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? '//ssl' : '//www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

  </body>
</html>
